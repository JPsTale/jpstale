# 文件类型说明

## 装备

### 模型

    `image/Sinimage/Items/DropItem/it{0}.smd`.format(item.dropItem);
        
### 图标

    `image/Sinimage/Items/{0}/it{1}.bmp`.format(item.folder, item.catetory);

### 脚本

文本文件。

记录了装备的名称、代码、价格、属性、装备需求等参数。

    `GameServer/OpenItem/{0}.txt`.format(item.catetory);

例 `OR133.txt`：

	*名字 "阿波罗之戒"
	*代码 "OR133"
	*重量 7
	*价格 120000
	*耐力再生 63 63
	*生命增加 150 155
	*魔法增加 150 150
	*耐力增加 1500 1500
	*等级 150
	*精神 140
	**随机特效 Knight Atalanta Mechanician Fighter Pikeman Archer Assassin Shaman Priestess Magician
	**生命再生 2.9 2.9


## 角色（Character）

玩家、怪物、NPC都属于角色，怪物是一种特殊的NPC。NPC可以与玩家交谈，可以与玩家交易物品。怪物则会尝试攻击视野范围内的敌对角色。

### 模型

**in、ini、inf**

文本文件。

这3种文件是同一种脚本，用于关联角色的“外观文件”和“动画文件”。这些文件被程序读取后，会生成inx文件、smb文件、smd文件。

有些模型不使用自身的动画，可能会使用共享的动画数据。

例1（`flag.inf`）：

	// 캐릭터 주인공 설정값
	*모양파일	wow.ase
	//*정밀모양	"MmhD03c_h"
	//*보통모양	"MmhD03c_h"
	//*저질모양	"MmhD03c_h"
	//*파일연결	M3bip.in

怪物的骨骼动画一般是存储在一个完整的ASE文件中的，ini脚本中记录了如何分解这些动画。

例2（`char/monster/death_knight/death_knight.ini`）：

	// 캐릭터 주인공 설정값
	// Model File
	*모양파일	death_knight.ASE
	
	// High Model
	*정밀모양	"death knight"
	// Default Model
	//*보통모양	"death knight"
	
	// Motion File
	*동작파일	death_knight.ASE
	
	*동작모음	"death_knight.ASE"
	
	// Animations
	//*启动 10 70 重复
	*서있기동작		10		70	반복
	//*走路 80 116 重复
	*걷는동작		80		116	반복
	//*跑 120 144 重复
	*뛰는동작		120		144	반복
	//오른쪽에서 왼쪽 从右到左
	//*攻击 320 364 340
	*공격동작		320		364	340
	//왼쪽에서 오른쪽 从左到右
	//*攻击1 380 425 405
	*공격동작1		380		425	405
	//*攻击2 440 485 467
	*공격동작2		440		485	467
	//*攻击3 250 310 268 285 P
	*공격동작3		250		310	268	285	P
	//*攻击4 570 630 589 608 L
	*공격동작4		570		630	589	608	L
	//*打击 150 173 K
	*타격동작		150		173	K
	//*技能 500 560 541 N
	*기술동작		500		560	541	N	
	//*机动小 180 238 A
	*죽기동작		180		238	A
	
	// End
	*끝

NPC的模型与怪物类似

例3：

`char/npc/bcn01/Bcn01.ini`

	// 캐릭터 주인공 설정값
	
	*모양파일	Bcn01.ASE
	
	*정밀모양	"Bcn01_h"
	*보통모양	"Bcn01_m"
	
	*동작파일	Bcn01.ASE
	
	*동작모음	"Bcn01.ASE"
	
	*걷는동작		140		176	
	
	*서있기동작		10		130	E	
	
	*표정파일연결	Bcn01f.in
	
	*끝

`char/npc/bcn01/Bcn01f.in`

	// NPC 표정 파일 설정값.
	
	*표정파일	Bcn01f.ASE
	
	// 말하기
	*표정모음	"Bcn01f.ASE"	
		
	*눈깜빡표정		10		16	(40)
	*아표정 		30		45	(30)
	*오표정			50		67	(30)
	
	// 표정 
	*표정모음	"Bcn01f.ASE"	
	
	*화난표정		80		130		(50)
	*무표정(작동않함)	1		30	P	(50)
	
	*끝


例4（`char/tmABCD/CtmbC92.ini`）：

	// Model File
	*모양파일		CtmbC92.ASE
	// Link File
	*파일연결		M4Bip.in
	// End
	*끝

上面这个脚本关联到了 `M4Bip.in` 文件，实际应该读取 `M4Bip.inx` 文件才对。

**inx**

二进制文件。

这种文件记录了角色模型、动画分别存储在什么位置。最重要的是，它记录了如何把完整的骨骼动画分解成若干个自动化。

**smb**

二进制文件。

这种文件存储了角色的骨骼，和骨骼动画。

**smd**

二进制文件。

这种文件存储了角色的模型存储在smd文件中。

### 脚本

**npc**

这种脚本专门描述NPC，只存储在服务端，路径为`GameServer/NPC/*.npc`。

例1：内维斯克的死亡竞赛NPC

    *属性 NPC
    *外型文件 "char\npc\SN-002\SN-002.ini"
    *生命力 100
    *名字 "水之精灵艾丽尔"
    *对话 "愿水的力量、智慧、美丽与你同在"
    *对话 "试炼塔的运营权由 'XXX' 所有" 
    *对话 "你来晚了,比赛正在进行"
    *对话 "愿水的力量、智慧、美丽与你同在" 
    *对话 "你看起来也很强"
    *对话 "现在不能进入" 
    *对话 "每天的收益将用于竞技场的维修"
    *对话 "进入竞技场需要支付费用" 
    *对话  "愿水的力量、智慧、美丽与你同在"
    *事件接受 2

例2：理查登的铁匠NPC

    *属性 NPC
    *外型文件 "char\npc\TN-004\TN-004.ini"
    *名字 "铁匠鲁加"
    *对话 "有什么需要的吗?"
    *排名 1021
    *生命力 100
    *武器出售 WA107 WA108 WA109 WC107 WC108 WC109 WH108 WH109 WH110	WP108 WP109 WP110	WS109 WS110 WS111	WS209 WS210 WS211
    *防具出售 DA108 DA109 DA110 DB107 DB108 DB109 DG107 DG108 DG109	OA207 OA208 OA209	DS107 DS108 DS109
    *物品出售 无

**inf**

这种文件记录了角色信息，一般是怪物的脚本。存储在服务端，路径为`GameServer/Monster/*.inf`。

	*属性			怪物
	*外型文件		"char\monster\Monclip\monclip.ini"
	*画面修正		0	14
	*名字			"地精"
	*等级			38
	//阁胶磐啊 劝悼窍绰 矫埃
	*活动时间		无限制
	//公府啊 鞘夸茄 阁胶磐狼 荐 弥家X-弥措X
	*组织			1 2
	//瘤瓷狼 备盒篮 1-10 鳖瘤狼 IQ 
	*智力			9
	//阁胶磐狼 己氢 好, 一般, 坏
	*品性			坏
	//阁胶磐啊 某腐磐甫 牢侥窍绰 芭府 1M = 27
	*视野			360
	//阁胶磐狼 HP
	*生命力			420
	//阁胶磐狼 傍拜仿
	*攻击力			26 44
	//阁胶磐狼 傍拜 软荐啦 XX% 父怒 单固瘤甫 软荐茄促. 
	*吸收率			6
	//规菩甫 电 阁胶磐狼 版快 喉钒啦捞 粮犁
	*格档率			0
	//阁胶磐狼 规绢仿 
	*防御			200
	//傍拜 加档狼 狐福扁 弥家 5 - 弥措 9
	*攻击速度		8
	//傍拜矫 傍拜狼 疙吝仿 (88)
	*命中			500
	//阁胶磐啊 啊瘤绊 乐绰 傍拜 菩畔狼 犬伏 备盒 (弥家 单固瘤 / 弥措 单固瘤 = m / m (+X)
	*特殊攻击率		20
	//阁胶磐狼 弊覆磊 农扁 小型, 中型, 大中型, 大型, 无
	*尺寸			中型
	//傍拜裹困 阁胶磐啊 傍拜 且 锭 傍拜 裹困甫 钎矫 
	*攻击范围		50
	//加己
	////////// 加己 历亲仿 //////////
	*魔属性			15
	*雷属性			0
	*冰属性			50
	*火属性			50
	*毒属性			50
	*概流			-4
	//不死系 有公 
	*怪物种族		恶魔系
	//阁胶磐狼 捞悼 加档 1-6狼 裹困 
	*移动速度		6
	//捞悼鸥涝
	*移动类型		0
	//拱距 肮荐 (阁胶磐啊 拱距阑 啊瘤绊 乐绰 荐)
	*药水储备		0
	//拱距 荤侩伏 (阁胶磐 惯积矫 拱距阑 啊瘤绊 唱棵 犬伏)
	*药水保留率		0
	//备盒 ( CYCLOPS / HOBGOBLIN / IMP / MINIG / PLANT / SKELETON / ZOMBI / OBIT )
	*音效			CRIP
	//阁胶磐 荤噶矫 有历甸俊霸 倒酒啊绰 版氰摹狼 剧
	*经验值			4300
	//阁胶磐啊 冻绢哆府绰 酒捞袍 汲沥 喉钒
	*物品数量		1
	*物品		4400	无
	*物品		3500	金	40 100
	*物品		1000	pl102 pl103 ps103 pl102 pm102
	*物品		700	da107 da207 wm106 wn106 ws106 wd106 ws206 wt105 pm102 ds105 or107 oa107 ec102 GP105 GP106 GP107 GP108 GP111
	*物品		300	da108 da208 wm107 wn107 ws107 wd107 ws207 wt106 db106 ds106 dg106 oa206 ec102 or107 oa107
	*物品		100	da109 da208 wm108 wn108 wa108 wd108 ws208 wt107 db107 ds107 dg107 oa207 ec102 os105 or108 oa108
	*连接文件	"name\38_Crypt.zhoon"

## 地区（Field）

### 模型

地图主体模型存储在smd文件中。

每张地图上有一些附属物体，保存在smd文件中。有些舞台物体是带有动画的，貌似也存储在smd文件中。

### 脚本

**spm**

文本文件。

这种文件存储了每个地图的刷怪规则。存储在服务端的`GameServre/Field/*.ase.spm`文件中

规则包括怪物的数量上限、怪物种类、刷怪频率、每种怪的刷新几率，Boss的刷新时间等。

	*怪物总数 200
	*出现间隔 5 14
	*数量 3
	*怪物种类 "蘑菇精" 12
	*怪物种类 "魔兽兵" 35
	*怪物种类 "火精灵" 10
	*怪物种类 "绿木精" 20
	*怪物种类 "独眼魔人" 3
	*怪物种类 "双足虫" 20
	*BOSS种类 "超级木精怪" "僵尸" 8 14 18 21 23 03

**spp**

二进制文件。

这种文件记录了每个地图中的刷怪点位置。每个地图最多只有200个刷怪点，每个刷怪点的数据由4个整数(共12字节)来存储，数据结构如下：

    struct STG_START_POINT {
        int state;// 标记这个点是否正在使用，0表示未使用，1表示使用。
        int x,z;// 记录刷怪点在大地图上的坐标。
    };

由于刷怪点的数量和刷怪点数据结构是固定的，因此每个spp文件的大小也是固定的，共2400字节。

**spc**

二进制文件。

这种文件存储了地图中的NPC信息。包括每个NPC的位置、朝向。其中的CharInfo则存储了NPC的详细属性。

一个地图中最多只能有个100个NPC，每个NPC有504字节，每个spc文件大小固定为50400字节。